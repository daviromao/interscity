image: ruby:2.3

# More about services: http://docs.gitlab.com/ee/ci/services/mysql.html
services:
  - mysql:latest

variables:
  # Configure MySQL environment variables (https://hub.docker.com/r/_/mysql/)
  MYSQL_DATABASE: data_collector_test
  MYSQL_ROOT_PASSWORD: admin

before_script:
  - ruby -v
  - which ruby
  - gem install bundler --no-ri --no-rdoc
  - bundle check || bundle install
  - bundle exec rake db:create RAILS_ENV=test
  - bundle exec rake db:migrate RAILS_ENV=test

rspec:
  script:
    - bundle exec rspec
